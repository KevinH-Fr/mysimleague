<div class="card-with-effect m-0">

  <h4 class="d-inline mx-1"> Events </h4>

  <% if current_user && verif_admin_ligue(current_user, session[:ligue])  %>
    <%= link_to "#", class: "btn btn-sm btn-warning m-2", "data-bs-toggle": "collapse", "data-bs-target": "#collapseEvent", "aria-expanded": "false" do %>
      <i class="fa-solid fa-square-plus fa-xl"></i>
    <% end %>
  <% end %>

  <div class="d-inline flex-wrap justify-content-center align-items-center">
    <% @events.each do |event| %>
      <%= link_to url_for(ligue: @ligue.id, saison: @saison.id, division: @division.id, event: event), 
            class: "btn btn-outline-primary btn-sm btn-event me-1 mb-1 p-1
            #{'fw-bold text-light btn-primary' if params[:event] == event.id.to_s}" do %>

        <%= image_tag(event.circuit.drapeau, class: "img-fluid rounded me-1", width: "25", height: "15") if event.circuit.drapeau.present? %>
        <%= "n° #{event.numero}" %>
      <% end %>
    <% end %>
  </div>

  <div class="collapse" id="collapseEvent">
    <div id="new_event">
      <%= render partial: "events/form", locals: { event: Event.new } %>
    </div>
  </div>


  <% if @event && @division %>

    <%# détail event courante %>
    <%= render @event %>

    <div class="card-event-topics">
      <% button_configs = [
        { path: display_resultats_menu_index_path, icon: "fa-square-poll-horizontal", text: "Résultats", color: "text-secondary" },
        { path: display_presences_menu_index_path, icon: "fa-street-view", text: "Présences", color: "text-success" },
        { path: display_dotds_menu_index_path, icon: "fa-star", text: "DOTD", color: "text-warning" },
        { path: display_dois_menu_index_path, icon: "fa-magnifying-glass", text: "DOI", color: "text-danger" },
        { path: display_synthese_licences_menu_index_path, icon: "fa-id-card", text: "Licences", color: "text-danger" },
        { path: display_paris_menu_index_path, icon: "fa-money-bill-wave", text: "Paris", color: "text-success" },
        { path: display_classement_pilotes_menu_index_path, icon: "fa-ranking-star", text: "Pilotes", color: "" },
        { path: display_classement_equipes_menu_index_path, icon: "fa-ranking-star", text: "Equipes", color: "" }
      ] %>

      <div class="d-flex flex-wrap justify-content-center align-items-center py-4">
        <% button_configs.each do |config| %>
          <%= button_to config[:path], class: "btn btn-sm m-1 btn-topic", 
              data: { controller: "button-color", action: "click->button-color#handleClick" } do %>
            <i class="fa fa-solid fa-xl <%= config[:icon] %>  <%= config[:color] %> <%= config[:text].downcase.parameterize %> <%= config[:color] %>"></i>
            <span class="ms-1 fw-bold text-light"><%= config[:text] %></span>
          <% end %>
        <% end %>
      </div>

      <div id="partial-container" class="partial-topic">
        <%# recoit le turbo stream avec elements cliqués %>
      </div>

    </div>

  <% end %>

</div>

<br> <br>


